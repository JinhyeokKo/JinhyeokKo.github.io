---
title: 주기억 장치
date: 2025-10-06
categories:
  - CS
tags:
  - 컴퓨터구조
layout: post
math: true
---

## 주기억 장치
- CPU와 가장 가까운 메모리 계층으로, 프로그램 실행 중 필요한 데이터를 임시로 저장하는 공간
- 컴퓨터의 데이터를 읽기 및 쓰기 작업에 빠르게 접근할 수 있도록 설계됨

#### 주기억 장치의 역할
**프로그램 명령어 저장**  
- 실행 중인 프로그램의 명령어가 저장
- CPU는 명령어를 명령어 사이클(인출 &rarr; 해독 &rarr; 실행)에 따라 처리

**데이터 저장**  
- 프로그램이 처리하는 데이터가 저장
- 연산 중인 중간값과 최종 결과도 저장

**CPU와 저장장치 간 데이터 중계**  
- 주기억 장치는 CPU와 하드디스크(보조기억장치) 사이에서 데이터를 빠르게 전달하는 역할

#### 주기억 장치의 특징
- **휘발성 메모리(Volatile Memory)** : 전원이 꺼지면 저장된 데이터가 사라짐  
- **직접 접근 가능** : CPU는 주기억 장치에 직접 접근하여 데이터를 읽고 씀

> 기존 CPU와 하드디스크 간의 속도 차이로 인해 CPU는 데이터를 전달 시 계속 대기해야 하는 현상이 발생하여 이러한 속도 차이를 해결하기 위해 중계 역할을 하는 주기억 장치를 사용  
> - 예를 들어 디스크에 저장된 게임을 실행할 경우 데이터 정보를 메모리로 이동시키고 이를 CPU가 통신하며 필요한 명령어를 처리

### 주기억 장치 - RAM과 주소 공간
#### RAM(Random Access Memory)
- 주기억 장치의 주요 구성 요소로, 실행 중인 프로그램과 데이터를 저장해 CPU가 빠르게 접근 가능
- 데이터를 읽고 쓰는 속도가 빠른 휘발성 메모리
- 임의 접근 가능 : 어느 위치든 동일한 시간에 접근 가능
- RAM 용량이 클수록 한 번에 많은 프로그램을 RAM에 적재하여 동시에 실행할 수 있음

#### 주소 공간
- 메모리의 각 위치를 식별하는 고유한 주소의 범위를 의미
- 메모리의 주소 공간은 물리 주소 또는 논리 주소로 표현

**물리 주소(Physical Address)**  
- 실제 메모리의 물리적인 위치를 나타냄

**논리 주소(logical Address)**  
- CPU에서 참조하는 가상의 주소
- CPU와 운영체제는 논리 주소를 물리 주소로 변환하여 데이터에 접근

> **논리 주소가 필요한 이유**  
> - 프로그램이 다른 물리 주소를 갖게 되더라도 CPU에서는 항상 동일한 논리 주소를 참조할 수 있음
> - 프로그램에 독립적인 논리 주소 공간을 할당하여 다른 프로그램의 메모리 침범 방지

### 주기억 장치 - MMU의 주소 변환
#### MMU(Memory Management Unit)
2개의 레지스터 정보를 사용하여 메모리 접근을 관리
- 베이스 레지스터(Base register) : 현재 프로그램의 메모리 시작 위치를 저장
- 한계 레지스터(Limit register) : 현재 프로그램의 메모리 크기(범위)를 저장

**주소 변환**  
- 물리주소 = 베이스 레지스터 + 논리 주소 

**접근 검증**
- 변환된 물리 주소가 베이스 레지스터, 베이스 레지스터 + 한계 레지스터 범위 내에 있는지 확인
- 만약 범위를 벗어나면 침범 탐지(트랩 또는 예외 발생) 후 접근 차단

```
프로그램 A
논리 주소 - 0~30
물리 주소 - 100~130

베이스 레지스터 - 100
한계 레지스터 - 30

CPU가 논리 주소 22에 접근할 때
-> 실제 메모리 주소 122에 접근

CPU가 논리주소 33에 접근할 때
-> 실제 메모리 주소 133은 주소 범위를 벗어나므로 예외 발생
```

> 현대에는 페이징 기법과 가상메모리가 도입되며 해당 방식은 거의 사용하지 않음  
> 하지만 해당 기법들도 주소 변환 원리를 기반으로 발전한 기법들이므로 해당 동작을 알아야 함

### 주기억 장치 - 캐시 기억 장치
- CPU는 내부 저장 장치로 레지스터를 사용하지만, 주기억 장치의 속도가 상대적으로 느려 속도 차이가 발생
- 이에 주기억 장치보다 빠른 캐시 기억 장치가 등장
- 캐시 기억 장치는 CPU와 주기억 장치 사이에 위치하여, 자주 수행되는 명령어나 피연산자를 미리 주기억 장치에서 가져와 저장
- CPU는 필요한 데이터를 먼저 캐시 기억 장치에서 검색하고, 없을 경우에만 주기억 장치에 접근하기 때문에 작업 속도가 크게 향상

**캐시 기억 장치에 원하는 데이터가 없는 경우**  
- 주기억 장치로부터 얻은 데이터를 캐시 기억 장치에 전송
- 캐시 기억 장치에서 다시 CPU로 전송

**캐시 기억 장치에 원하는 데이터가 있는 경우**  
- 캐시 기억 장치에서 CPU로 직접 전송

### 주기억 장치 - 적중률과 평균 기억 장치 접근 시간
캐시 기억 장치의 적중률은 '적중 횟수'를 '적중 횟수와 실패 횟수의 합'으로 나눈 것  
- 적중률 85% &rarr; CPU가 필요한 데이터를 캐시 기억 장치에서 검색할 때, 100번 중 85번은 캐시 기억 장치에 데이터가 존재

#### 평균 기억 장치 접근 시간 계산법
평균 기억 장치 접근 시간(T_avg), 캐시 기억 장치 접근 시간(T_cache), 주기억 장치 접근 시간(T_main), 적중률(H)

$$T_{avg} = H \cdot T_{cache} + (1 - H) \cdot T_{main}$$

> 1. 적중률 90%, 캐시 기억 장치 접근 시간 50ns, 주기억 장치 접근 시간 400ns일 때 평균 기억 장치 접근 시간은 (0.9 * 50ns) + (0.1 * 400ns) = 85ns
> 2. 적중률 95%, 캐시 기억 장치 접근 시간 50ns, 주기억 장치 접근 시간 400ns 일 때 평균 기억 장치 접근 시간은 (0.95 * 50ns) + (0.05 * 400ns) = 67.5ns

- 기본적으로 주기억 장치 접근 시간보다 캐시 기억 장치 접근 시간이 빠르기 때문에 적중률이 높을수록 평균적인 기억 장치 접근 시간이 감소