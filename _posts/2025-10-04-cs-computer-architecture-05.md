---
title: CPU 성능 향상 기법
date: 2025-10-04
categories:
  - CS
tags:
  - 컴퓨터구조
layout: post
math : true
---

## CPU 성능 향상 기법
### CPU 성능 향상 기법 - 인터럽트
방해하다(interrupt)라는 의미를 가진 것처럼, CPU가 현재 실행 중인 작업을 잠시 멈추고 중요한 이벤트를 처리한 뒤, 원래의 프로그램으로 복귀하도록 하는 것

#### 하드웨어 인터럽트
- 외부 장치(하드웨어)에서 발생하는 인터럽트
- 일반적으로 인터럽트는 하드웨어 인터럽트를 가리킴
- 키보드 입력, 마우스 클릭, 타이머 이벤트, 네트워크 패킷 도착 등

#### 소프트웨어 인터럽트
- 소프트웨어에서 발생하는 인터럽트
- 시스템 호출(Syscall) : 프로세스가 커널 서비스 요청
- 예외(Exception) : 프로그램 오류(0으로 나누기 등)

### CPU 성능 향상 기법 - 인터럽트 처리 과정
1. 인터럽트 요청 신호 발생 
	- 하드웨어 장치(입출력 장치)에서 CPU에게 인터럽트 요청
2. 현재 상태 저장
	- CPU는 인터럽트 요청 신호를 받고 현재 상태(레지스터, PC)를 `스택`에 저장
3. 인터럽트 처리
	- CPU는 인터럽트를 처리하기 위해 `인터럽트 벡터`를 참조
	- `인터럽트 벡터`에 맞는 `인터럽트 서비스 루틴`을 실행하여 인터럽트를 처리
4. 상태 복원
	- 인터럽트 처리 후 `스택`에 저장했던 작업 상태를 복원하고 중단되었던 작업을 재개

> **스택** : 기존 처리하던 작업 정보를 담고 있으며 주기억 장치의 일부를 차지  
> **인터럽트 벡터** : 각 인터럽트 요청에 대응하는 인터럽트 서비스 루틴의 주소를 저장  
> **인터럽트 서비스 루틴** : 특정 인터럽트를 처리하는 작업이 정의되어 있음


### CPU 성능 향상 기법 - 명령어 파이프라이닝
#### 명령어 파이프라이닝
- 한 번에 하나의 명령어만 실행하는 것이 아니라 동시에 여러 명령을 실행하는 기법
- 각 명령어 처리 과정을 몇 단계로 분리하고 명령어를 실행하는 도중에 다음 명령어의 실행을 시작하여 성능을 향상
- 각 단계에 드는 시간이 명령어마다 동일하지 않으면 파이프라이닝에 의한 속도 향상을 기대할 수 없으므로 파이프라인의 단계 수를 증가시켜 각 단계의 명령어 처리 시간을 같게(시간 차이가 거의 없도록) 해야 함

#### 2단계 명령어 파이프라이닝
- 명령어 처리 과정을 인출 단계, 실행 단계라는 2단계로 나눔
- 한 클록에서 2개의 명령어를 각기 다른 단계를 동시에 실행

> **클록**  
> - CPU의 동작을 동기화하고 명령어 실행 속도를 결정하는 신호로, 초당 주기(Hz)로 측정
> - 클록의 주기는 CPU가 한 작업을 처리하는 기본 단위로 사용

#### 4단계 명령어 파이프라이닝
- 명령어 인출, 명령어 해독, 오퍼랜드 인출, 명령어 실행 단계로 나눔
- 한 클록에서 4개의 명령어의 각기 다른 단계를 동시에 실행

#### 6단계 명령어 파이프라이닝
- 명령어 인출, 명령어 해독, 오퍼랜드 계산, 오퍼랜드 인출, 명령어 실행, 오퍼랜드 저장 단계로 나눔
- 한 클록에서 6개의 명령어의 각기 다른 단계를 동시에 실행

| 클록 주기 | 1 클록    | 2 클록    | 3 클록     | 4 클록     | 5 클록     | 6 클록     | 7클록     |
| :---: | ------ | ------ | ------- | ------- | ------- | ------- | ------- |
| 명령어1  | 명령어 인출 | 명령어 해독 | 오퍼랜드 계산 | 오퍼랜드 인출 | 명령어 실행  | 오퍼랜드 저장 |         |
| 명령어 2  |        | 명령어 인출 | 명령어 해독  | 오퍼랜드 계산 | 오퍼랜드 인출 | 명령어 실행  | 오퍼랜드 저장 |
| 명령어 3  |        |        | 명령어 인출  | 명령어 해독  | 오퍼랜드 계산 | 오퍼랜드 인출 | 명령어 실행  |

- 이처럼 명령어의 각기 다른 단계를 한 클록에서 동시에 실행할 수 있으며 명령어가 추가되더라도 해당 클록이 진행하고 있지 않은 단계를 진행함으로써 여러 명령어를 동시에 실행

### CPU 성능 향상 기법 - 파이프라이닝에 의한 속도 향상

#### $$T = k + (N -1)$$
파이프라인의 단계 수를 k, 실행할 명령어의 수는 N, 각 파이프라인 단계가 한 클록 주기씩 걸린다고 가정하면 전체 명령어 실행 시간은 이와 같다.

#### $$S = \frac{kN}{k + (N - 1)}$$
파이프라이닝이 적용되지 않으면 실행 시간은 단순히 k와 N의 곱이다.  
따라서 파이프라이닝에 의한 속도 향상은 이와 같다.

#### $$\lim_{N\to\infty} S = \lim_{N\to\infty} \frac{kN}{k + (N - 1)} = k$$

명령어의 수(N)가 매우 많아질 때 속도 향상은 다음과 같이 표현된다.  
즉, 이상적인 상황에서 k 단계 명령어 파이프라이닝 기법에서는 k 배의 속도 향상을 기대할 수 있다.

### CPU 성능 향상 기법 - 추가적인 기법들
#### 슈퍼 스칼라 프로세서
- 파이프라이닝 기법에 병렬 처리를 지원하는 것
- 한 번에 n개의 명령어를 병렬 처리할 수 있는 n등급의 슈퍼 스칼라 프로세서는 이론적으로 단일 파이프라이닝 기법에 비해 n 배의 성능 향상을 기대할 수 있음

#### 슈퍼 파이프라이닝
- 기존 파이프라이닝 기법에서 클록 주기를 n분의 1로 줄여 실행 속도를 높이는 기법
- 명령어 수(N)가 매우 많아지면 기존 파이프라이닝 기법에 비해 n 배의 속도 향상을 기대할 수 있음

$$\lim_{N\to\infty}\frac{k + N - 1}{k + k + \frac{N - 1}{n}} = n$$

#### 슈퍼 파이프라이닝 슈퍼 스칼라
- 슈퍼 파이프라이닝 + 슈퍼 스칼라 프로세서
- 클록 주기를 n분의 1로 줄이고 m 등급의 슈퍼 스칼라 프로세서를 사용한다고 할 때, 명령어 수(N)가 매우 많아지면 기존 파이프라이닝 기법에 비해 mn 배의 속도 향상을 기대할 수 있음

$$\lim_{N\to\infty}\frac{k + N - 1}{k + \frac{N - 1}{nm}} = mn$$
