---
layout: page
# The Category layout
---
{% include lang.html %}

<div id="page-category">
  <h1 class="ps-lg-2">
    <i class="far fa-folder-open fa-fw text-muted"></i>
    {{ page.title }}
    <span class="lead text-muted ps-2">{{ page.posts | size }}</span>
  </h1>

  <!-- Tag Filter Section -->
  <div class="tag-filter mb-4">
    {% assign all_tags = "" | split: "" %}
    {% for post in page.posts %}
    {% if post.tags %}
    {% for tag in post.tags %}
    {% assign all_tags = all_tags | push: tag %}
    {% endfor %}
    {% endif %}
    {% endfor %}

    {% assign unique_tags = all_tags | uniq | sort %}

    {% if unique_tags.size > 0 %}
    <div class="btn-group" id="tag-filter-buttons">
      <button class="btn btn-outline-primary active" data-tag="all">All Posts</button>
      {% for tag in unique_tags %}
      <button class="btn btn-outline-primary" data-tag="{{ tag | slugify }}">{{ tag }}</button>
      {% endfor %}
    </div>
    {% endif %}
  </div>

  <ul class="content ps-0">
    {% for post in page.posts %}
    <li class="d-flex justify-content-between px-md-3 post-item"
        {% if post.tags %}
        data-tags="{% for tag in post.tags %}{{ tag | slugify }} {% endfor %}"
        {% endif %}>
      <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
      <span class="dash flex-grow-1"></span>

      <!-- Display tags for each post -->
      <div class="post-tags me-2">
        {% if post.tags.size > 0 %}
        <span class="text-muted">[
            {% for tag in post.tags %}
              <span class="tag-badge">{{ tag }}</span>
              {% unless forloop.last %}, {% endunless %}
            {% endfor %}
            ]</span>
        {% endif %}
      </div>

      {% include datetime.html date=post.date class='text-muted small text-nowrap' lang=lang %}
    </li>
    {% endfor %}
  </ul>
</div>

<!-- Add CSS for styling -->
<style>
  .post-tags {
    font-size: 0.85em;
  }

  .tag-badge {
    color: var(--text-muted-color);
  }

  .post-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.6rem;
  }

  #tag-filter-buttons .btn {
    margin-right: 0.3rem;
    margin-bottom: 0.3rem;
  }
</style>

<script>
  // 페이지 로드 후 실행
  window.addEventListener('load', function() {
    console.log("태그 필터링 스크립트 로드됨");

    // 모든 필터 버튼 찾기
    const filterButtons = document.querySelectorAll("#tag-filter-buttons .btn");
    const postItems = document.querySelectorAll(".post-item");

    // 각 버튼에 클릭 이벤트 추가
    filterButtons.forEach(function(button) {
      button.addEventListener('click', function(e) {
        e.preventDefault();

        const selectedTag = this.getAttribute("data-tag");
        console.log("버튼 클릭됨:", selectedTag);

        // 활성화된 버튼 스타일 변경
        filterButtons.forEach(function(btn) {
          btn.classList.remove("active");
        });
        this.classList.add("active");

        // 포스트 필터링
        if (selectedTag === "all") {
          for (let i = 0; i < postItems.length; i++) {
            postItems[i].style.display = "flex";
          }
        } else {
          for (let i = 0; i < postItems.length; i++) {
            const item = postItems[i];
            const postTags = item.getAttribute("data-tags") || "";
            if (postTags.includes(selectedTag)) {
              item.style.display = "flex";
            } else {
              item.style.display = "none";
            }
          }
        }
      });
    });
  });
</script>
